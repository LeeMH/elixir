# Dynamic Form

## ê°•ì˜ ì£¼ìš” ë‚´ìš©

* dynamic form ì— ëŒ€í•œ ì²˜ë¦¬
* form event ì²˜ë¦¬

![[Pasted image 20240423143250.png]]
## 1. dynamic formì— ëŒ€í•œ ì²˜ë¦¬

* `if` ì§€ì‹œì–´ë¥¼ í†µí•´ íŠ¹ì • ì˜ì—­ì„ dynamic í•˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.
* ìœ„ ê·¸ë¦¼ì—ì„œ ë…¹ìƒ‰ ì ì„  ë¶€ë¶„ì€ `price`ê°€ nilì´ ì•„ë‹ ë•Œ ë Œë”ë§ ë˜ë„ë¡ `<div :if={@price} class="quote">` ì²˜ë¦¬í–ˆë‹¤.
* ë˜í•œ, formì— ëŒ€í•´ì„œ `change`ì™€ `submit` ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ë„ë¡ ì„¤ì •í–ˆë‹¤.

```elixir
Â  def render(assigns) do
Â  Â  ~H"""
Â  Â  <h1>Build A Sandbox</h1>
Â  Â  <div id="sandbox">
Â  Â    ## form changeì™€ submit ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ë„ë¡ ì„¤ì •
Â  Â  Â  <form phx-change="calculate" phx-submit="get-quote">
Â  Â  Â  Â  <div class="fields">
Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  <label for="length">Length</label>
Â  Â  Â  Â  Â  Â  <div class="input">
Â  Â  Â  Â  Â  Â  Â  <input type="number" name="length" value={@length} />
Â  Â  Â  Â  Â  Â  Â  <span class="unit">feet</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  <label for="width">Width</label>
Â  Â  Â  Â  Â  Â  <div class="input">
Â  Â  Â  Â  Â  Â  Â  <input type="number" name="width" value={@width} />
Â  Â  Â  Â  Â  Â  Â  <span class="unit">feet</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  <label for="depth">Depth</label>
Â  Â  Â  Â  Â  Â  <div class="input">
Â  Â  Â  Â  Â  Â  Â  <input type="number" name="depth" value={@depth} />
Â  Â  Â  Â  Â  Â  Â  <span class="unit">inches</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="weight">
Â  Â  Â  Â  Â  You need <%= @weight %> pounds of sand ğŸ
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <button type="submit">
Â  Â  Â  Â  Â  Get A Quote
Â  Â  Â  Â  </button>
Â  Â  Â  </form>

      ## ì•„ë˜ :ifì™€ ê°™ìŒ. 
Â  Â  Â  <!--
Â  Â  Â  <%= if @price do %>
Â  Â  Â  Â  <div class="quote">
Â  Â  Â  Â  Â  Get your personal beach today for only <%= number_to_currency(
Â  Â  Â  Â  Â  Â  @price
Â  Â  Â  Â  Â  ) %>
Â  Â  Â  Â  </div>
Â  Â  Â  <% end %>
Â  Â  Â  -->
Â  Â  Â  ## price != nilì¸ ê²½ìš°ë§Œ ë Œë”ë§ ë¨
Â  Â  Â  <div :if={@price} class="quote">
Â  Â  Â  Â  Get your personal beach today for only <%= number_to_currency(
Â  Â  Â  Â  Â  @price
Â  Â  Â  Â  ) %>
Â  Â  Â  </div>
Â  Â  </div>
Â  Â  """
Â  end
```


## 2. form event ì²˜ë¦¬

* change ì´ë²¤íŠ¸ì— ëŒ€ì‘í•˜ëŠ” calcuateì™€ submitì— ëŒ€ì‘í•˜ëŠ” get-quote ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•œë‹¤.
* get-quote ì´ë²¤íŠ¸ ì²˜ë¦¬ ì‹œ, `price ê°’ë§Œ ì…‹íŒ…` í•œë‹¤. websocketìœ¼ë¡œ ì—°ê²°ë˜ì–´ ìˆê³ , ëª¨ë“  ìƒíƒœëŠ” ìœ ì§€ë˜ê¸° ë•Œë¬¸ì´ë‹¤.
```elixir
  ## get-quote ì´ë²¤íŠ¸ ì²˜ë¦¬
Â  def handle_event("get-quote", _params, socket) do
Â  Â  price = Sandbox.calculate_price(socket.assigns.weight)  

Â  Â  {:noreply, assign(socket, price: price)}
Â  end  

  ## caculate ì´ë²¤íŠ¸ ì²˜ë¦¬
Â  def handle_event("calculate", params, socket) do
Â  Â  %{"length" => l, "width" => w, "depth" => d} = params
Â  Â  weight = Sandbox.calculate_weight(l, w, d)  

Â  Â  socket = assign(socket, length: l, width: w, depth: d, weight: weight, price: nil) 

Â  Â  {:noreply, socket}
Â  end
```